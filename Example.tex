% FIRST DRAFT - 18/06/2022

\documentclass[10pt, a4paper]{article}
\usepackage[margin=2cm]{geometry}
\usepackage[sfdefault]{arimo}
\usepackage[T1]{fontenc}

\usepackage{amsmath, amsfonts, amssymb}
\usepackage{mathrsfs} 
\usepackage{mathtools} 

\usepackage{enumitem}

\usepackage{graphicx}
\usepackage{float}


\usepackage{xcolor}
\definecolor{linkcolour}{rgb}{0,0.2,0.6}
% hyperref, metadata
\usepackage{hyperref}
\hypersetup{pdfauthor={Li, Binghuan}}
\hypersetup{colorlinks,breaklinks,urlcolor=linkcolour, linkcolor=linkcolour}

\usepackage{tcolorbox}


% \title{A very simple example in finite difference method}
% \author{Adopted from \href{http://www.sze.hu/~lotfi/FINITE-DIFFERENCE-METHODS.pdf}{http://www.sze.hu/~lotfi/FINITE-DIFFERENCE-METHODS.pdf}}
% \date{} % omit date
\begin{document}
% \maketitle

\begin{tcolorbox}[title = \textbf{\huge Example}]
{\large\textbf{\textit{\underline{Problem}}}}\newline \newline
Approximate the solution of the initial value problem
    \[y^{\prime\prime} - (1-\frac{x}{5})y=x, 
    \quad y(1)=2 \ \text{and} \ y(3)=-1
    \]
on the interval $\displaystyle 1 \leq x\leq 3$.\newline \newline

{\large\textbf{\textit{\underline{Solution}}}}\newline \newline
We set $x_{n} = x_{0}+nh$, where $x_{0}=2$, $h=0.5$ is the spacing between two nodes. Let $y_{n}$ be the calculated approximation for $y_{n} = y(x_{n})$.
\begin{figure}[H]
    \centering
    \includegraphics[width=.6\textwidth]{imgs/FD-example.eps}
\end{figure}
\noindent Use the central-difference approximation to construct the ODE:
    \[
    \frac{y_{i+1}-2y_{i}+y_{i-1}}{\Delta x^{2}} - (1-\frac{x_{i}}{5})y_{i} = x_{i}, \quad i=1, 2, 3
    \]
This gives:
    \[
    y_{i-1} - \bigg[ 2+(1-\frac{x_{i}}{5})\Delta x^{2} \bigg]y_{i} +y_{i+1} = x_{i}\Delta x^{2}, \quad i=1, 2, 3
    \]
For $i=1$, 
    \[
    y_{0} - \bigg[ 2+(1-\frac{1.5}{5})(0.5)^{2} \bigg]y_{1} + y_{2} = 1.5(0.5)^{2}
    \]
For $i=2$, 
    \[
    y_{1} - \bigg[ 2+(1-\frac{2}{5})(0.5)^{2} \bigg]y_{2} + y_{3} = 2(0.5)^{2}
    \]
For $i=3$, 
    \[
    y_{2} - \bigg[ 2+(1-\frac{2.5}{5})(0.5)^{2} \bigg]y_{3} + y_{4} = 2.5(0.5)^{2}
    \]
Set $y_{0} = y(1) = 2$ and $y_{4} = y(3) = -1$, we get the system of equations with the three unknowns $y_{1}, y_{2}, y_{3}$:
    \[
    \begin{bmatrix}
    -2.175  &   1   &   0\\
    1   &   -2.150  &   1\\
    0   &   1   &   -2.125
    \end{bmatrix}
    \begin{pmatrix}
    y_{1} \\
    y_{2} \\
    y_{3} \\
    \end{pmatrix}
    =
    \begin{bmatrix}
    -1.625 \\
    0.5 \\
    1.625 \\
    \end{bmatrix}
    \]
Solve $y_{1}, y_{2}, y_{3}$ by finding the inverse of the coefficient matrix:
    \[
     \begin{pmatrix}
    y_{1} \\
    y_{2} \\
    y_{3} \\
    \end{pmatrix}
    =
    \begin{bmatrix}
    -2.175  &   1   &   0\\
    1   &   -2.150  &   1\\
    0   &   1   &   -2.125
    \end{bmatrix}^{-1}
    \begin{bmatrix}
    -1.625 \\
    0.5 \\
    1.625 \\
    \end{bmatrix}
    \]
    
\end{tcolorbox}
\end{document}